# PDF 解析库对比报告（修订版）

基于实测数据：阿里开发手册-泰山版.pdf（62页）

---

## 一、PDFMiner

### 优点

- **底层解析能力强**：完全基于 Python，实现了对 PDF 文档结构的细粒度解析
- **灵活性高**：适合复杂定制化处理，比如自定义版面分析、字符级操作
- **纯 Python 实现**：跨平台、易于安装
- **成熟稳定**：老牌库，文档较多

### 缺点

- **学习曲线陡峭**：API 偏底层，需理解 PDF 对象
- **性能较差**：11.54秒处理62页（0.19秒/页）
- **缺乏高层抽象**：**不支持原生表格检测**，段落合并需自己实现
- **输出文本可读性差**：常有换行混乱

### 实测数据

- 总耗时：**11.54秒**（0.19秒/页）
- 文本提取：5.67秒，70,027字符
- 表格提取：**不支持**
- 图片检测：5.84秒，66个图片

---

## 二、PDFPlumber

### 优点

- **高层抽象**：基于 PDFMiner 封装，API 友好
- **文本提取质量高**：自动段落识别、中文优化（64,026字符）
- **表格处理能力强**：检测到32个表格，仅0.57秒，支持无边框表格
- **API Pythonic**：方法清晰，学习成本低
- **MIT 许可证**：无商业限制

### 缺点

- **性能中等**：7.27秒处理62页（0.12秒/页）
- **内存占用高**：大 PDF 易 OOM
- **功能单一**：只做提取，不支持编辑
- **跨页支持差**：表格、段落需手动拼接

### 实测数据

- 总耗时：**7.27秒**（0.12秒/页）
- 文本提取：6.66秒，64,026字符
- 表格提取：0.57秒，**32个表格**（表现最好）
- 图片检测：0.00秒，33个图片

---

## 三、PyMuPDF (fitz)

### 优点

- **性能极强**：4.18秒处理62页（0.07秒/页），**比 PDFPlumber 快 1.7倍**
- **功能最全**：提取 + 编辑 + 创建 + 合并
- **文本提取最快**：0.13秒提取66,450字符
- **图片处理强**：支持原始图像提取与高质量渲染
- **工业级稳定**：适合大规模并发处理

### 缺点

- **表格检测较弱**：仅检测到16个表格（PDFPlumber检测到32个），耗时3.89秒
- **文本格式一般**：忠实保留结构，需后处理
- **学习成本高**：API 底层复杂
- **许可证限制**：AGPL v3，闭源商业需付费 ⚠️

### 实测数据

- 总耗时：**4.18秒**（0.07秒/页）⚡**最快**
- 文本提取：**0.13秒**，66,450字符 ⚡
- 表格提取：3.89秒，16个表格（检测能力较弱）
- 图片检测：0.15秒，31个图片

---

## 四、PyMuPDF4LLM

### 优点

- **专为 LLM 优化**：自动生成 GitHub 兼容的 Markdown 格式
- **智能内容排序**：自动按正确的阅读顺序组织文本、表格、图片
- **一站式方案**：一个函数调用完成所有提取工作
- **格式化输出**：自动识别标题层级、列表、代码块等
- **图片嵌入**：支持图片提取和 Markdown 引用

### 缺点

- **性能适中**：7.32秒处理62页（0.12秒/页），与 PDFPlumber 相当
- **表格处理待验证**：部分复杂表格可能被识别为图片
- **可控性较低**：封装较高，底层细节控制有限
- **仍处于发展阶段**：相对较新的库

### 实测数据

- 总耗时：**7.32秒**（0.12秒/页）
- Markdown输出：67,845字符
- 特点：集成了文本、表格、图片的自动提取和排序

---

## 五、MarkItDown

### 优点

- **极简 API**：一行代码完成转换 `md.convert(pdf_path)`
- **速度较快**：5.67秒处理62页（0.09秒/页）
- **自动 Markdown 转换**：直接输出格式化的 Markdown

### 缺点

- **文本提取质量未知**：68,010字符，格式化质量待评估
- **表格支持极弱**：仅检测到2行表格（vs PDFPlumber的32个表格）
- **不支持图片提取**：无法提取或保存 PDF 中的图片
- **黑盒设计**：底层依赖库决定能力，难以细粒度控制和调试

### 实测数据

- 总耗时：**5.67秒**（0.09秒/页）
- 输出内容：68,010字符，5,507行
- 表格检测：**仅2行**（能力最弱）
- 图片提取：**不支持**

---

## 六、Unstructured

### 优点

- **多策略支持**：提供 fast（纯规则）和 hi_res（AI模型）两种策略
- **文档结构识别**：能识别标题、段落、列表、页眉页脚等多种元素类型
- **智能去重**：内部自动处理嵌套文本框，避免重复输出
- **元素级元数据**：每个元素包含页码、坐标等丰富的元数据信息
- **Apache 2.0 许可证**：商业友好

### 缺点

- **表格处理极弱**：fast 策略下表格以**纯文本输出，完全无表格结构** ❌
- **图片检测能力差**：fast 策略下**几乎无法检测和提取图片** ❌
- **元素过度分割**：提取2242个元素（vs 其他库的页级处理），导致输出碎片化
- **性能一般**：8.27秒处理61页（0.14秒/页），比 PyMuPDF 慢 2倍
- **依赖 AI 模型**：要获得完整能力需使用 hi_res 策略，需下载模型且需要 GPU
- **黑盒处理**：内部自动去重和元素分类，难以精确控制输出

### 实测数据（fast 策略 - 纯规则）

- 总耗时：**8.27秒**（0.14秒/页）
- 元素提取：2242个元素
- 元素分布：
  - Title: 1169
  - Text: 429
  - ListItem: 223
  - NarrativeText: 191
  - Header: 157
  - Footer: 73
- 表格检测：**0个结构化表格**（全部以文本输出）❌
- 图片检测：**0个图片** ❌

---

## 七、综合对比表

| 特性 | PDFMiner | PDFPlumber | PyMuPDF | PyMuPDF4LLM | MarkItDown | Unstructured (fast) |
|---|---|---|---|---|---|---|
| **性能（秒/页）** | 0.19 ❌ | 0.12 ⚠️ | **0.07 ✅** | 0.12 ⚠️ | 0.09 ✅ | 0.14 ⚠️ |
| **总耗时（62页）** | 11.54s | 7.27s | **4.18s ✅** | 7.32s | 5.67s | 8.27s |
| **文本提取速度** | 5.67s | 6.66s | **0.13s ✅** | 7.32s（含处理） | 5.67s | 8.27s |
| **文本字符数** | 70,027 | 64,026 | 66,450 | 67,845 | 68,010 | - |
| **表格检测能力** | **不支持 ❌** | **32个 ✅** | 16个 ⚠️ | 待验证 ⚠️ | **2行 ❌** | **0个（纯文本）❌** |
| **表格提取速度** | - | **0.57s ✅** | 3.89s ❌ | 集成在总时间 | - | - |
| **图片检测** | 66个 | 33个 | 31个 | 支持 ✅ | **不支持 ❌** | **0个 ❌** |
| **图片提取速度** | 5.84s | 0.00s | 0.15s | 集成在总时间 | - | - |
| **结构识别** | 无 | 基础 | 基础 | 强 | 无 | **强（元素分类）✅** |
| **元素数量** | - | - | - | - | - | 2242个（过度分割）⚠️ |
| **Markdown输出** | 需自己实现 | 需自己实现 | 需自己实现 | **原生支持 ✅** | **原生支持 ✅** | 需自己实现 |
| **内容排序** | 需自己实现 | 需自己实现 | 需自己实现 | **自动排序 ✅** | 自动 | 需自己实现 |
| **编辑能力** | 无 | 无 | **强 ✅** | 无 | 无 | 无 |
| **易用性** | 难 ❌ | **简单 ✅** | 中等 | **简单 ✅** | **极简 ✅** | 简单 |
| **可控性** | 高 | 高 | 高 | 中等 | **低 ❌** | **低 ❌** |
| **AI 能力** | 无 | 无 | 无 | 无 | 无 | 可选（hi_res）⚠️ |
| **许可证** | MIT | MIT | **AGPL v3 ⚠️** | AGPL v3 ⚠️ | Apache 2.0 | Apache 2.0 |

---

## 八、修正说明

基于实测数据，原报告的以下内容需要修正：

### 1. 性能评估修正
- **原报告错误**："PyMuPDF 比 PDFPlumber 快 3-5 倍"
- **实际数据**：PyMuPDF（4.18秒）比 PDFPlumber（7.27秒）快 **1.7倍**
- **结论**：性能优势确实存在，但没有原报告描述的那么夸张

### 2. 表格处理能力修正
- **原报告错误**：
  - "PDFPlumber 表格处理能力强"（✓ 正确）
  - "PyMuPDF 表格识别弱"（✓ 正确）
  - "PDFMiner 几乎无表格处理能力"（✓ 正确）
- **实际数据**：
  - PDFPlumber：**32个表格**（0.57秒）✅ **最强**
  - PyMuPDF：16个表格（3.89秒）⚠️ 数量少且慢
  - PDFMiner：**不支持原生表格检测** ❌
  - MarkItDown：仅2行 ❌
  - Unstructured (fast)：**0个结构化表格** ❌ **最弱**

### 3. MarkItDown 评估修正
- **原报告错误**："速度较快"
- **实际情况**：速度确实较快（5.67秒），但**表格和图片能力极弱**
- **结论**：不适合需要结构化数据提取的场景

### 4. Unstructured 新增发现
- **核心问题**：
  - fast 策略下**完全无法提取表格结构**（全部以文本输出）
  - fast 策略下**完全无法检测图片**
  - 元素过度分割（2242个），但内部已做去重处理
- **优势**：
  - 文档结构识别能力强（能区分Title/Header/Footer/ListItem等）
  - 需要使用 hi_res 策略（AI模型）才能发挥完整能力
- **结论**：**不适合作为纯规则PDF提取工具**，核心价值在AI增强的文档理解

---

## 九、适用场景建议（修订版）

### 1. 高性能文本提取 → **PyMuPDF**
- 需要快速处理大量PDF（0.07秒/页）
- 主要关注文本内容，对表格要求不高
- ⚠️ 注意AGPL v3许可证限制

### 2. 高质量表格提取 → **PDFPlumber**
- 需要准确提取表格数据（32个 vs PyMuPDF的16个）
- 表格提取速度快（0.57秒）
- 文本提取质量也较高
- MIT许可证，商业友好

### 3. LLM/RAG 应用 → **PyMuPDF4LLM**
- 需要将PDF转为LLM友好的Markdown格式
- 需要自动排序和格式化内容
- 一站式解决方案，减少后处理工作
- ⚠️ 表格处理能力需要具体场景验证

### 4. 快速原型验证 → **MarkItDown**
- 仅需要基础文本提取
- 不涉及表格和图片处理
- 追求最简API

### 5. PDF编辑和创建 → **PyMuPDF**
- 需要修改、合并、创建PDF
- 唯一支持编辑功能的库
- 性能最强

### 6. 深度定制化 → **PDFMiner**
- 需要精确控制PDF内部结构
- 研究型项目
- ⚠️ 性能最慢（0.19秒/页），不适合生产环境

### 7. AI增强文档理解 → **Unstructured (hi_res)**
- 需要使用AI模型进行复杂布局分析
- 需要精确的文档结构识别（标题层级、段落、列表等）
- ⚠️ **fast 策略不推荐**：无表格和图片能力
- ⚠️ hi_res 策略需要GPU，超出纯规则库的对比范畴

---

## 十、关键发现

### 1. 表格提取能力排名
1. **PDFPlumber**：32个表格，0.57秒 🏆
2. PyMuPDF：16个表格，3.89秒
3. PyMuPDF4LLM：待进一步验证
4. MarkItDown：2行（基本不可用）
5. PDFMiner：不支持
6. **Unstructured (fast)**：0个结构化表格 ❌ **垫底**

### 2. 图片检测能力排名
1. PDFMiner：66个图片
2. PDFPlumber：33个图片
3. PyMuPDF：31个图片
4. PyMuPDF4LLM：支持
5. **MarkItDown**：不支持 ❌
6. **Unstructured (fast)**：0个图片 ❌ **垫底**

### 3. 性能排名（总耗时）
1. **PyMuPDF**：4.18秒 🏆
2. MarkItDown：5.67秒
3. PDFPlumber：7.27秒
4. PyMuPDF4LLM：7.32秒
5. Unstructured (fast)：8.27秒
6. PDFMiner：11.54秒

### 4. 综合推荐
- **生产环境（文本为主）**：PyMuPDF
- **生产环境（表格为主）**：PDFPlumber
- **LLM应用**：PyMuPDF4LLM
- **快速验证（纯文本）**：MarkItDown
- **文档结构分析（需AI）**：Unstructured (hi_res)
- **研究项目**：PDFMiner

### 5. Unstructured 核心结论
- ✅ **优势**：文档结构识别和元素分类能力强
- ❌ **劣势**：fast 策略下**完全无表格和图片能力**
- ⚠️ **定位**：专注于AI增强的文档理解，不是传统PDF提取工具的替代品
- 📊 **数据**：0表格 + 0图片 + 8.27秒 = **不适合通用PDF提取场景**

---

**最后提醒**：选择库时需要综合考虑：
- 性能要求（处理速度）
- 提取质量（特别是表格和图片）
- 许可证限制（商业使用）
- 功能需求（编辑、格式化、AI能力等）
- **Unstructured 的 fast 策略不适合需要表格和图片提取的场景**